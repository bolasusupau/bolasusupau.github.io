<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Peta Kunjungan Senini, 28 April 2025</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
  <div id="map" style="height: 100vh;"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // Inisialisasi peta
    var map = L.map('map').setView([-6.997, 107.635], 15);

    // Tambahkan layer peta
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);

    // Data titik dengan koordinat dan warna (untuk memudahkan penggantian)
    var titik = [
      {
        koordinat: [-6.9857917, 107.6448421],
        warna: 'green',
        popup: 'Warung Pak Amas'
      },
      {
        koordinat: [-6.9880258, 107.6468441],
        warna: 'green',
        popup: 'Titik 2'
      },
      {
        koordinat: [-6.9886601, 107.6520015],
        warna: 'green',
        popup: 'MUR BAUT & ALAT TEKNIK'
      },
      {
        koordinat: [-7.0053033, 107.6495618],
        warna: 'yellow',
        popup: 'Titik 4'
      },
      {
        koordinat: [-7.0065547, 107.6545212],
        warna: 'yellow',
        popup: 'Titik 5'
      },
      {
        koordinat: [-7.0033815, 107.6583764],
        warna: 'yellow',
        popup: 'Titik 6'
      },
      {
        koordinat: [-6.970812, 107.6507261],
        warna: 'green',
        popup: 'Titik 7'
      },
      {
        koordinat: [-6.9687327, 107.6499555],
        warna: 'green',
        popup: 'Warung Teh Enni'
      },
      {
        koordinat: [-6.975835, 107.649511],
        warna: 'green',
        popup: 'Titik 9'
      }
    ];

    // Loop untuk menambahkan marker dengan warna berbeda sesuai data
    titik.forEach(function (item) {
      L.circleMarker(item.koordinat, {
        color: item.warna,  // Warna garis marker
        fillColor: item.warna, // Warna isi marker
        fillOpacity: 0.7,  // Opasitas warna isi
        radius: 10  // Ukuran marker
      }).addTo(map)
      .bindPopup(item.popup);  // Menampilkan popup dengan nama titik
    });

    // Lokasi khusus (lokasi saya) - Menambahkan titik kamu sendiri (contoh)
    var lokasiSaya = [-6.997, 107.635];

    // Buat marker khusus untuk "saya"
    var myIcon = L.icon({
      iconUrl: 'https://cdn-icons-png.flaticon.com/512/64/64113.png', // contoh icon custom
      iconSize: [38, 38], // ukuran ikon
      iconAnchor: [19, 38], // posisi titik ikon
      popupAnchor: [0, -38] // posisi popup relatif ke ikon
    });

    // Marker untuk posisi saya (akan diperbarui secara live)
    var myMarker = L.marker(lokasiSaya, {icon: myIcon}).addTo(map);
    myMarker.bindPopup('Saya di sini!').openPopup();

    // Fungsi untuk mendapatkan lokasi saya secara live
    function updateLocation(position) {
      var lat = position.coords.latitude;
      var lng = position.coords.longitude;

      // Update marker ke lokasi baru
      myMarker.setLatLng([lat, lng]);

      // Update peta agar tetap fokus pada lokasi saya
      map.setView([lat, lng], 15);  // Ganti level zoom jika perlu
    }

    // Cek jika geolocation tersedia dan dapatkan lokasi pengguna
    if (navigator.geolocation) {
      navigator.geolocation.watchPosition(updateLocation, function(error) {
        alert("Tidak dapat mengambil lokasi Anda.");
      }, {
        enableHighAccuracy: true,
        timeout: 10000,  // timeout jika tidak berhasil dalam 10 detik
        maximumAge: 0    // jangan gunakan lokasi yang sudah terlalu lama
      });
    } else {
      alert("Geolocation tidak didukung di browser ini.");
    }
  </script>
</body>
</html>
